message from Shav
some modification from test branch
some changes from master
final changes that needs to go to master branch
